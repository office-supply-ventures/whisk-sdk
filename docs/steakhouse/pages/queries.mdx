# Queries

Query functions for server-side usage, Node.js scripts, Next.js server components, or any non-React context.

## getStats

Fetch Steakhouse stats: unique depositor count and current TVL breakdown by chain, protocol, and asset category. Optionally include historical TVL snapshots.

### Current stats only

```ts twoslash
import { SteakhouseClient, getStats } from "@whisk/steakhouse"

const client = new SteakhouseClient({ apiKey: "your-api-key" })

const stats = await getStats(client) // [!code focus]

stats.uniqueDepositors        // Unique depositor count (or null)
stats.tvl.current.totalUsd       // Total TVL in USD
stats.tvl.current.byChain        // Breakdown by chain (name, id, icon, tvlUsd)
stats.tvl.current.byProtocol     // Breakdown by protocol (protocol, tvlUsd)
stats.tvl.current.byAssetCategory // Breakdown by asset category (category, tvlUsd)
```

### With historical TVL

Pass `{ includeHistorical: true }` to also fetch daily historical TVL snapshots (last 365 days, oldest first).

```ts twoslash
import { SteakhouseClient, getStats } from "@whisk/steakhouse"

const client = new SteakhouseClient({ apiKey: "your-api-key" })

const stats = await getStats(client, { includeHistorical: true }) // [!code focus]

stats.tvl.historical // TvlSnapshot[] â€” daily snapshots

// Each snapshot has a timestamp and the same breakdowns as stats.tvl.current
for (const snapshot of stats.tvl.historical!) {
  snapshot.timestamp     // Unix timestamp (seconds)
  snapshot.totalUsd      // Total TVL at this point in time
  snapshot.byChain       // Chain breakdown at this point
  snapshot.byProtocol    // Protocol breakdown at this point
  snapshot.byAssetCategory // Asset category breakdown at this point
}
```
